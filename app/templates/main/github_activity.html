<!-- GitHub Activity Widget -->
<section class="terminal-window mb-12" id="github-activity-section" style="display: none;">
    <div class="terminal-header">
        <div class="flex items-center space-x-4">
            <div class="terminal-controls">
                <div class="terminal-control control-close"></div>
                <div class="terminal-control control-minimize"></div>
                <div class="terminal-control control-maximize"></div>
            </div>
            <span class="terminal-primary text-sm font-bold">
                <i class="fab fa-github mr-2"></i>
                recent_commits.log
            </span>
        </div>
    </div>
    
    <div class="p-8">
        <h2 class="text-2xl font-bold terminal-primary mb-6 text-center neon-glow">
            <i class="fas fa-code-branch mr-2"></i>
            Recent GitHub Activity
        </h2>
        
        <div id="github-activity-content">
            <div class="text-center py-8">
                <i class="fas fa-spinner fa-spin text-4xl terminal-secondary"></i>
                <p class="terminal-muted mt-4">Loading recent commits...</p>
            </div>
        </div>
        
        <div class="text-center mt-6">
            <a href="{{ config.GITHUB_URL }}" target="_blank" class="terminal-button">
                <i class="fab fa-github mr-2"></i>
                View Full GitHub Profile
            </a>
        </div>
    </div>
</section>

<script>
// Load GitHub activity
async function loadGitHubActivity() {
    try {
        const response = await fetch('/api/github/activity');
        const data = await response.json();
        
        if (data.activity && data.activity.length > 0) {
            displayGitHubActivity(data.activity);
            document.getElementById('github-activity-section').style.display = 'block';
        }
    } catch (error) {
        // Silently handle GitHub API errors
    }
}

function displayGitHubActivity(activity) {
    const container = document.getElementById('github-activity-content');
    
    const activityHTML = activity.slice(0, 10).map(commit => {
        const date = new Date(commit.date);
        const timeAgo = getTimeAgo(date);
        
        return `
            <div class="border-l-4 border-green-400 pl-4 py-3 mb-4 hover:bg-gray-900/30 transition-all">
                <div class="flex items-center justify-between mb-2">
                    <h3 class="font-bold terminal-primary">
                        <i class="fas fa-code-branch mr-2"></i>
                        ${commit.repo}
                    </h3>
                    <span class="text-xs terminal-muted">${timeAgo}</span>
                </div>
                <p class="terminal-text text-sm leading-relaxed">${commit.message}</p>
                <a href="${commit.url}" target="_blank" class="text-xs terminal-secondary hover:terminal-primary transition-colors">
                    <i class="fas fa-external-link-alt mr-1"></i>
                    View commit
                </a>
            </div>
        `;
    }).join('');
    
    container.innerHTML = activityHTML;
}

function getTimeAgo(date) {
    const now = new Date();
    const diffInSeconds = Math.floor((now - date) / 1000);
    
    if (diffInSeconds < 60) return 'just now';
    if (diffInSeconds < 3600) return `${Math.floor(diffInSeconds / 60)}m ago`;
    if (diffInSeconds < 86400) return `${Math.floor(diffInSeconds / 3600)}h ago`;
    return `${Math.floor(diffInSeconds / 86400)}d ago`;
}

// Load activity when page loads
document.addEventListener('DOMContentLoaded', function() {
    // Small delay to let other content load first
    setTimeout(loadGitHubActivity, 1000);
});
</script>